# üìò CRM Telegram Integration ‚Äî Project Guide

## 1. –û –ø—Ä–æ–µ–∫—Ç–µ
–≠—Ç–æ CRM-—Å–∏—Å—Ç–µ–º–∞ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π **Telegram Business**, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –æ—Ç–≤–µ—á–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞–º —Å –ø–æ–º–æ—â—å—é AI (OpenAI + RAG) –∏–ª–∏ –≤—Ä—É—á–Ω—É—é.

**–°—Ç–µ–∫:**
- **Frontend/Backend:** Next.js 16 (App Router)
- **Database:** Supabase (PostgreSQL)
- **AI:** OpenAI (GPT-4o)
- **Styling:** Vanilla CSS + Shadcn UI
- **Auth:** Supabase SSR (Cookies sync)

## 2. –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (`/dashboard/admin`)
–î–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å —Ä–æ–ª—å—é `admin` –≤ —Ç–∞–±–ª–∏—Ü–µ `profiles`.

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏: `Trial` (14 –¥–Ω–µ–π), `Full` (30 –¥–Ω–µ–π), `Inactive`.
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∞–º–∏: –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ/—Å–Ω—è—Ç–∏–µ —Ä–æ–ª–∏ `admin`.
- **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:** –ü—Ä—è–º–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (Auth + Profile) –∏–∑ –ø–∞–Ω–µ–ª–∏.

**–ö–∞–∫ –≤—ã–¥–∞—Ç—å —Å–µ–±–µ –∞–¥–º–∏–Ω–∞ (SQL):**
```sql
UPDATE profiles SET role = 'admin' WHERE email = 'your-email@example.com';
```

## 3. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ Auth
- **Middleware:** `middleware.ts` –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å–µ—Å—Å–∏–∏ Supabase –º–µ–∂–¥—É –±—Ä–∞—É–∑–µ—Ä–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º —á–µ—Ä–µ–∑ Cookies. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã Server Actions.
- **Supabase Clients:**
  - `lib/supabase/client.ts` ‚Äî –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (`createBrowserClient`).
  - `lib/supabase/server.ts` ‚Äî –¥–ª—è API –∏ Server Actions (`createServerClient`).
  - `lib/supabase/admin.ts` ‚Äî —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç —Å `SERVICE_ROLE_KEY` –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π –≤ –æ–±—Ö–æ–¥ RLS (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ!).

## 4. –î–µ–ø–ª–æ–π –∏ –û–∫—Ä—É–∂–µ–Ω–∏–µ (Vercel)
–ü—Ä–∏ –¥–µ–ø–ª–æ–µ –Ω–∞ Vercel –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–±–∞–≤—å—Ç–µ —ç—Ç–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
- `SUPABASE_SERVICE_ROLE_KEY` ‚Äî –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á (Project Settings -> API).
- `NEXT_PUBLIC_SUPABASE_URL` / `NEXT_PUBLIC_SUPABASE_ANON_KEY` ‚Äî –ü—É–±–ª–∏—á–Ω—ã–µ –∫–ª—é—á–∏.
- `OPENAI_API_KEY` ‚Äî –î–ª—è —Ä–∞–±–æ—Ç—ã AI.
- `ENCRYPTION_KEY` ‚Äî –î–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤ –≤ –ë–î.
- `NEXT_PUBLIC_APP_URL` ‚Äî URL –≤–∞—à–µ–≥–æ —Å–∞–π—Ç–∞ (–±–µ–∑ —Å–ª–µ—à–∞ –Ω–∞ –∫–æ–Ω—Ü–µ).

**Workflow:** `git push origin main` -> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π.

## 5. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ AI
–ï—Å–ª–∏ –≤—ã –Ω–∞—á–∏–Ω–∞–µ—Ç–µ –Ω–æ–≤—ã–π —á–∞—Ç —Å –ò–ò, —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç —Ç–µ–∫—Å—Ç:

> "–Ø —Ä–∞–±–æ—Ç–∞—é –Ω–∞–¥ CRM-–ø—Ä–æ–µ–∫—Ç–æ–º (Next.js 16 + Supabase SSR). 
> –í –ø—Ä–æ–µ–∫—Ç–µ —É–∂–µ –≤–Ω–µ–¥—Ä–µ–Ω–∞ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (/dashboard/admin), –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–µ—Å—Å–∏–π —á–µ—Ä–µ–∑ middleware.ts –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã Server Actions –≤ app/actions/admin-actions.ts. 
> –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–∞–±–ª–∏—Ü—É profiles –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–æ–ª–µ–π (user/admin) –∏ —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–æ–¥–ø–∏—Å–∫–∏ (active/trial/inactive).
> –¢–µ–∫—É—â–∞—è –∑–∞–¥–∞—á–∞: [–û–ü–ò–®–ò–¢–ï –í–ê–®–£ –ó–ê–î–ê–ß–£ –ó–î–ï–°–¨]"

## 6. –í–∞–∂–Ω—ã–µ –Ω—é–∞–Ω—Å—ã
- **Server Components:** –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É "Server Components render", –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é `supabaseAdmin` –∏ –Ω–∞–ª–∏—á–∏–µ `SERVICE_ROLE_KEY`.
- **Telegram Webhooks:** –ü—Ä–∏ —Å–º–µ–Ω–µ –¥–æ–º–µ–Ω–∞ –≤—Å–µ–≥–¥–∞ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ `NEXT_PUBLIC_APP_URL` –∏ –ø–µ—Ä–µ–ø—Ä–∏–≤—è–∑—ã–≤–∞–π—Ç–µ –±–æ—Ç–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö CRM.

---
*Updated by Antigravity*
